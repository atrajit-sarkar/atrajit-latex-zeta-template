%=============================================================================
% EMERALD THEME - Sophisticated Academic Green
% A refined theme inspired by nature and classical academia
%=============================================================================

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{atrajit-emerald}[2025/11/17 Emerald Theme for Academic Documents]

%=============================================================================
% ESSENTIAL PACKAGES
%=============================================================================

\RequirePackage{amsmath, amssymb, amsthm}
\RequirePackage{mathtools}
\RequirePackage{bm}
\RequirePackage{mathrsfs}
\RequirePackage{xcolor}
\RequirePackage{graphicx}
\RequirePackage{tikz}
\RequirePackage{tikz-cd}
\usetikzlibrary{positioning, shapes.misc, shapes.symbols, shapes.geometric, decorations.pathmorphing, decorations.markings, shadows}
\RequirePackage{geometry}
\RequirePackage{fancyhdr}
\RequirePackage{enumitem}
\RequirePackage{fontawesome}
\RequirePackage[backend=biber, style=alphabetic]{biblatex}
\RequirePackage{hyperref}

%=============================================================================
% EMERALD COLOR PALETTE - Nature-Inspired Elegance
%=============================================================================

\definecolor{emeraldPrimary}{RGB}{16,123,78}      % Rich emerald green
\definecolor{emeraldSecondary}{RGB}{34,139,34}    % Forest green
\definecolor{emeraldDark}{RGB}{0,86,63}           % Deep jade
\definecolor{emeraldLight}{RGB}{144,238,144}      % Light sage
\definecolor{emeraldAccent}{RGB}{46,204,113}      % Bright mint

%=============================================================================
% HYPERLINK CONFIGURATION - Subtle Emerald Accents
%=============================================================================

\hypersetup{
    colorlinks=true,
    linkcolor=emeraldDark,
    citecolor=emeraldPrimary,
    urlcolor=emeraldSecondary,
    bookmarksnumbered=true
}

%=============================================================================
% PAGE GEOMETRY - Professional Academic Layout
%=============================================================================

\geometry{
    a4paper,
    top=2.5cm,
    bottom=3cm,
    left=2.5cm,
    right=2.5cm,
    headheight=20pt
}

%=============================================================================
% THEOREM ENVIRONMENTS - Elegant Emerald Styling
%=============================================================================

\theoremstyle{definition}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{exercise}[theorem]{Exercise}

%=============================================================================
% SECTION FORMATTING - Nature-Inspired Headers
%=============================================================================

\newcommand{\currentSubsectionMarkEmerald}{}

% Section: Display with leaf symbol (‚ù¶)
\renewcommand{\sectionmark}[1]{%
    \markboth{{\scshape\S\,\thesection}\enspace\raisebox{-0.15ex}{$\cdot$}\enspace#1}{}%
}

% Subsection: Display with section symbol
\renewcommand{\subsectionmark}[1]{%
    \markright{\S\,\thesubsection\enspace#1}%
    \gdef\currentSubsectionMarkEmerald{%
        \S\,\thesubsection\enspace#1%
    }%
}

%=============================================================================
% CUSTOM UTILITY COMMANDS
%=============================================================================

% TODO marker with leaf icon
\newcommand{\todotea}{\textbf{\textcolor{emeraldPrimary}{TODO}}~\faLeaf}

% Note marker with info icon
\newcommand{\notebell}{\textcolor{emeraldPrimary}{\faInfoCircle}\enspace\textbf{Note:}}

% Important marker with star
\newcommand{\important}{\textcolor{emeraldAccent}{\faStar}\enspace\textbf{Important:}}

%=============================================================================
% UTILITY MACROS AND VISUAL ELEMENTS - EMERALD THEME
%=============================================================================

%-----------------------------------------------------------------------------
% Mathematical Decorations - Leaf Symbol Design
%-----------------------------------------------------------------------------

% Elegant leaf symbol with natural organic styling
\providecommand{\zetacircle}{%
    \tikz[baseline=-0.6ex]{
        % Outer hexagonal frame with rounded corners
        \draw[
            emeraldDark,
            line width=0.6pt,
            rounded corners=1pt
        ] (0,0.58em) -- (0.5em,0.29em) -- (0.5em,-0.29em) -- 
          (0,-0.58em) -- (-0.5em,-0.29em) -- (-0.5em,0.29em) -- cycle;
        
        % Inner circle with natural gradient
        \fill[emeraldLight!30] (0,0) circle (0.5em);
        \draw[
            emeraldSecondary,
            line width=0.5pt
        ] (0,0) circle (0.5em);
        
        % Decorative leaf accent
        \node[
            text=emeraldPrimary,
            font=\Large,
            inner sep=0pt
        ] at (0,0) {$\heartsuit$};
    }%
}

%-----------------------------------------------------------------------------
% Footer Design: Organic Vine Banner
%-----------------------------------------------------------------------------

\providecommand{\fancyFootPageNum}{
    \setlength{\footskip}{50pt}
    \renewcommand{\footrulewidth}{0pt}
    \fancyfoot[C]{
        \vspace{6pt}
        \begin{tikzpicture}[baseline=(page.base)]
            % Left vine decoration
            \draw[emeraldSecondary, line width=0.5pt, decorate, 
                  decoration={snake, amplitude=0.3mm, segment length=3mm}] 
                (-2,0) -- (-0.8,0);
            
            % Left leaf
            \node[
                text=emeraldAccent,
                font=\footnotesize
            ] (left) at (-0.5,0) {$\spadesuit$};
            
            % Main page number badge with leaf motif
            \node[
                rectangle,
                rounded corners=3pt,
                draw=emeraldPrimary,
                fill=emeraldLight!15,
                line width=0.5pt,
                inner xsep=8pt,
                inner ysep=3pt,
                text=emeraldDark,
                font=\small\bfseries,
                drop shadow={opacity=0.1, shadow xshift=0.5pt, shadow yshift=-0.5pt}
            ] (page) at (0,0) {\thepage};
            
            % Right leaf
            \node[
                text=emeraldAccent,
                font=\footnotesize
            ] (right) at (0.5,0) {$\spadesuit$};
            
            % Right vine decoration
            \draw[emeraldSecondary, line width=0.5pt, decorate,
                  decoration={snake, amplitude=0.3mm, segment length=3mm}] 
                (0.8,0) -- (2,0);
            
        \end{tikzpicture}%
    }
}

% Helper to test for empty tokens
\providecommand{\ifBlankTF}[3]{%
    \if\relax\detokenize{#1}\relax #2\else #3\fi
}

%-----------------------------------------------------------------------------
% Header Design: Natural Academic Elegance
%-----------------------------------------------------------------------------

\providecommand{\fancyHeaderContent}{
    % Custom header rule with organic feel
    \renewcommand{\headrulewidth}{0pt}
    
    % Decorative header lines
    \fancyhead[L]{%
        \begin{tikzpicture}[remember picture, overlay]
            \draw[emeraldSecondary, line width=0.5pt] 
                ([yshift=-2pt]current page.north west) ++(\oddsidemargin+1in,0) -- 
                ++(\textwidth,0);
            \draw[emeraldAccent, line width=0.2pt, opacity=0.4] 
                ([yshift=-3.8pt]current page.north west) ++(\oddsidemargin+1in,0) -- 
                ++(\textwidth,0);
        \end{tikzpicture}%
    }
    
    % Center header: Section information with leaf decoration
    \fancyhead[C]{%
        \footnotesize\itshape\color{emeraldDark}%
        \nouppercase{\leftmark}%
        \enspace%
        \textcolor{emeraldAccent}{$\sim$}%
        \;\zetacircle\;%
        \textcolor{emeraldAccent}{$\sim$}%
        \enspace%
        \nouppercase{\rightmark}%
    }
    
    % Right header: Nature icon
    \fancyhead[R]{%
        \footnotesize\textcolor{emeraldSecondary}{\faLeaf}%
    }
}

%-----------------------------------------------------------------------------
% Ornamental Section Break
%-----------------------------------------------------------------------------

% Decorative section separator with organic elements
\providecommand{\sectionbreak}{%
    \vspace{1em}
    \begin{center}
        \begin{tikzpicture}
            % Left vine
            \draw[emeraldAccent, line width=0.3pt, opacity=0.6, decorate,
                  decoration={snake, amplitude=0.2mm, segment length=2mm}] 
                (-2.2,0) -- (-0.8,0);
            
            % Left leaf
            \node[text=emeraldSecondary, font=\small] at (-0.5,0) {$\spadesuit$};
            
            % Central emerald symbol
            \node at (0,0) {\zetacircle};
            
            % Right leaf
            \node[text=emeraldSecondary, font=\small] at (0.5,0) {$\spadesuit$};
            
            % Right vine
            \draw[emeraldAccent, line width=0.3pt, opacity=0.6, decorate,
                  decoration={snake, amplitude=0.2mm, segment length=2mm}] 
                (0.8,0) -- (2.2,0);
        \end{tikzpicture}
    \end{center}
    \vspace{1em}
}

%=============================================================================
% MATHEMATICAL AND TEXT MACROS - EMERALD THEME
%=============================================================================

%-----------------------------------------------------------------------------
% Common Mathematical Sets (Blackboard Bold)
%-----------------------------------------------------------------------------

\providecommand{\RR}{\mathbb{R}}  % Real numbers
\providecommand{\NN}{\mathbb{N}}  % Natural numbers
\providecommand{\ZZ}{\mathbb{Z}}  % Integers
\providecommand{\QQ}{\mathbb{Q}}  % Rational numbers
\providecommand{\CC}{\mathbb{C}}  % Complex numbers

%-----------------------------------------------------------------------------
% Equation Numbering Control
%-----------------------------------------------------------------------------

\providecommand{\useSubsubsectionEqNum}{%
    \numberwithin{equation}{subsection}%
}

%-----------------------------------------------------------------------------
% Highlighted Text Commands - Emerald Palette
%-----------------------------------------------------------------------------

% Mathematical term highlighting
\providecommand{\mathterm}[1]{%
    \textcolor{emeraldPrimary}{\textbf{#1}}%
}

% Definition term highlighting
\providecommand{\defterm}[1]{%
    \textcolor{emeraldDark}{\textit{\textbf{#1}}}%
}

% Code or literal text
\providecommand{\code}[1]{%
    \texttt{\textcolor{emeraldSecondary}{#1}}%
}

%-----------------------------------------------------------------------------
% Key Concept Box - Emerald Nature Style
%-----------------------------------------------------------------------------

\providecommand{\keybox}[1]{%
    \begin{center}
        \begin{tikzpicture}
            \node[
                rectangle,
                rounded corners=4pt,
                draw=emeraldPrimary,
                fill=emeraldLight!10,
                line width=0.8pt,
                inner sep=10pt,
                drop shadow={opacity=0.15, shadow xshift=1pt, shadow yshift=-1pt}
            ] {
                \begin{minipage}{0.85\textwidth}
                    \centering
                    #1
                \end{minipage}
            };
        \end{tikzpicture}
    \end{center}
}

%-----------------------------------------------------------------------------
% Reference Shortcuts - Quick Linking
%-----------------------------------------------------------------------------

\providecommand{\thmref}[1]{Theorem~\ref{#1}}
\providecommand{\lemref}[1]{Lemma~\ref{#1}}
\providecommand{\propref}[1]{Proposition~\ref{#1}}
\providecommand{\corref}[1]{Corollary~\ref{#1}}
\providecommand{\defref}[1]{Definition~\ref{#1}}
\providecommand{\exref}[1]{Example~\ref{#1}}
\providecommand{\exerref}[1]{Exercise~\ref{#1}}
\providecommand{\secref}[1]{Section~\ref{#1}}
\providecommand{\chapref}[1]{Chapter~\ref{#1}}
\providecommand{\figref}[1]{Figure~\ref{#1}}
\providecommand{\tabref}[1]{Table~\ref{#1}}
\providecommand{\eqnref}[1]{Equation~\eqref{#1}}

%=============================================================================
% HEADER & FOOTER SETUP
%=============================================================================

\pagestyle{fancy}
\fancyhf{}
\setlength{\headheight}{26pt}

% Plain page style for title pages and chapter beginnings
\fancypagestyle{plain}{%
	\fancyhf{}
	\renewcommand{\headrulewidth}{0pt}
	\fancyFootPageNum
}

\fancyHeaderContent
\fancyFootPageNum

\endinput
