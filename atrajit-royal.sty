%=============================================================================
% ROYAL THEME - Elegant Purple & Gold Luxury
% A sophisticated theme inspired by royal manuscripts and luxury design
%=============================================================================

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{atrajit-royal}[2025/11/17 Royal Theme for Academic Documents]

%=============================================================================
% ESSENTIAL PACKAGES
%=============================================================================

\RequirePackage{amsmath, amssymb, amsthm}
\RequirePackage{mathtools}
\RequirePackage{bm}
\RequirePackage{mathrsfs}
\RequirePackage{xcolor}
\RequirePackage{graphicx}
\RequirePackage{tikz}
\RequirePackage{tikz-cd}
\usetikzlibrary{positioning, shapes.misc, shapes.symbols, shapes.geometric, decorations.pathmorphing, decorations.markings, shadows}
\RequirePackage{geometry}
\RequirePackage{fancyhdr}
\RequirePackage{enumitem}
\RequirePackage{fontawesome}
\RequirePackage[backend=biber, style=alphabetic]{biblatex}
\RequirePackage{hyperref}

%=============================================================================
% ROYAL COLOR PALETTE - Regal Luxury
%=============================================================================

\definecolor{royalPrimary}{RGB}{75,0,130}         % Deep royal purple
\definecolor{royalSecondary}{RGB}{138,43,226}     % Blue violet
\definecolor{royalDark}{RGB}{48,25,52}            % Dark purple
\definecolor{royalLight}{RGB}{230,230,250}        % Lavender
\definecolor{royalAccent}{RGB}{218,165,32}        % Goldenrod

%=============================================================================
% HYPERLINK CONFIGURATION - Royal Purple Accents
%=============================================================================

\hypersetup{
    colorlinks=true,
    linkcolor=royalPrimary,
    citecolor=royalSecondary,
    urlcolor=royalDark,
    bookmarksnumbered=true
}

%=============================================================================
% PAGE GEOMETRY - Luxurious Layout
%=============================================================================

\geometry{
    a4paper,
    top=2.5cm,
    bottom=3cm,
    left=2.5cm,
    right=2.5cm,
    headheight=20pt
}

%=============================================================================
% THEOREM ENVIRONMENTS - Royal Styling
%=============================================================================

\theoremstyle{definition}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{exercise}[theorem]{Exercise}

%=============================================================================
% SECTION FORMATTING - Crown-Inspired Headers
%=============================================================================

\newcommand{\currentSubsectionMarkRoyal}{}

% Section: Display with crown symbol
\renewcommand{\sectionmark}[1]{%
    \markboth{{\scshape\S\,\thesection}\enspace\raisebox{-0.15ex}{$\cdot$}\enspace#1}{}%
}

% Subsection: Display with section symbol
\renewcommand{\subsectionmark}[1]{%
    \markright{\S\,\thesubsection\enspace#1}%
    \gdef\currentSubsectionMarkRoyal{%
        \S\,\thesubsection\enspace#1%
    }%
}

%=============================================================================
% CUSTOM UTILITY COMMANDS
%=============================================================================

% TODO marker with magic icon
\newcommand{\todotea}{\textbf{\textcolor{royalPrimary}{TODO}}~\faMagic}

% Note marker with gem icon
\newcommand{\notebell}{\textcolor{royalSecondary}{\faGem}\enspace\textbf{Note:}}

% Important marker with star
\newcommand{\important}{\textcolor{royalAccent}{\faStar}\enspace\textbf{Important:}}

%=============================================================================
% UTILITY MACROS AND VISUAL ELEMENTS - ROYAL THEME
%=============================================================================

%-----------------------------------------------------------------------------
% Mathematical Decorations - Crown Symbol Design
%-----------------------------------------------------------------------------

% Elegant crown symbol with royal luxury styling
\providecommand{\zetacircle}{%
    \tikz[baseline=-0.6ex]{
        % Outer decorative frame with gold accent
        \draw[
            royalAccent,
            line width=0.7pt,
            rounded corners=0.5pt
        ] (0,0.6em) -- (0.52em,0.3em) -- (0.52em,-0.3em) -- 
          (0,-0.6em) -- (-0.52em,-0.3em) -- (-0.52em,0.3em) -- cycle;
        
        % Inner circle with royal gradient
        \fill[royalLight!40] (0,0) circle (0.5em);
        \draw[
            royalPrimary,
            line width=0.6pt
        ] (0,0) circle (0.5em);
        
        % Crown decoration
        \node[
            text=royalSecondary,
            font=\small,
            inner sep=0pt
        ] at (0,0.02em) {$\bigstar$};
        
        % Small gold dots for luxury
        \foreach \angle in {45,135,225,315} {
            \fill[royalAccent, opacity=0.6] (\angle:0.42em) circle (0.04em);
        }
    }%
}

%-----------------------------------------------------------------------------
% Footer Design: Regal Banner with Gold Accents
%-----------------------------------------------------------------------------

\providecommand{\fancyFootPageNum}{
    \setlength{\footskip}{50pt}
    \renewcommand{\footrulewidth}{0pt}
    \fancyfoot[C]{
        \vspace{6pt}
        \begin{tikzpicture}[baseline=(page.base)]
            % Left royal ornament
            \node[
                text=royalAccent,
                font=\small
            ] (left) at (-1.8,0) {$\clubsuit$};
            
            % Left decorative line with gradient effect
            \draw[royalSecondary, line width=0.5pt] 
                (-1.5,0) -- (-0.6,0);
            \draw[royalAccent, line width=0.3pt, opacity=0.5] 
                (-1.5,0.05) -- (-0.6,0.05);
            
            % Main page number shield
            \node[
                rectangle,
                rounded corners=4pt,
                draw=royalPrimary,
                fill=royalLight!20,
                line width=0.7pt,
                inner xsep=10pt,
                inner ysep=4pt,
                text=royalPrimary,
                font=\small\bfseries,
                drop shadow={opacity=0.2, shadow xshift=0.8pt, shadow yshift=-0.8pt, fill=royalDark}
            ] (page) at (0,0) {\thepage};
            
            % Gold crown accent above page number
            \node[
                text=royalAccent,
                font=\tiny,
                yshift=8pt
            ] at (page.north) {$\bigstar$};
            
            % Right decorative line
            \draw[royalSecondary, line width=0.5pt] 
                (0.6,0) -- (1.5,0);
            \draw[royalAccent, line width=0.3pt, opacity=0.5] 
                (0.6,0.05) -- (1.5,0.05);
            
            % Right royal ornament
            \node[
                text=royalAccent,
                font=\small
            ] (right) at (1.8,0) {$\clubsuit$};
            
        \end{tikzpicture}%
    }
}

% Helper to test for empty tokens
\providecommand{\ifBlankTF}[3]{%
    \if\relax\detokenize{#1}\relax #2\else #3\fi
}

%-----------------------------------------------------------------------------
% Header Design: Royal Manuscript Style
%-----------------------------------------------------------------------------

\providecommand{\fancyHeaderContent}{
    % Custom header rule with regal styling
    \renewcommand{\headrulewidth}{0pt}
    
    % Decorative header lines with gold accent
    \fancyhead[L]{%
        \begin{tikzpicture}[remember picture, overlay]
            \draw[royalPrimary, line width=0.6pt] 
                ([yshift=-2pt]current page.north west) ++(\oddsidemargin+1in,0) -- 
                ++(\textwidth,0);
            \draw[royalAccent, line width=0.3pt, opacity=0.6] 
                ([yshift=-4pt]current page.north west) ++(\oddsidemargin+1in,0) -- 
                ++(\textwidth,0);
        \end{tikzpicture}%
    }
    
    % Center header: Section information with crown decoration
    \fancyhead[C]{%
        \footnotesize\itshape\color{royalDark}%
        \leftmark%
        \ifBlankTF{\rightmark}{}{%
            \enspace%
            \textcolor{royalAccent}{$\sim$}%
            \;\zetacircle\;%
            \textcolor{royalAccent}{$\sim$}%
            \enspace%
            \rightmark%
        }%
    }
    
    % Right header: Magic icon
    \fancyhead[R]{%
        \footnotesize\textcolor{royalSecondary}{\faMagic}%
    }
}

%-----------------------------------------------------------------------------
% Ornamental Section Break
%-----------------------------------------------------------------------------

% Decorative section separator with royal luxury
\providecommand{\sectionbreak}{%
    \vspace{1.2em}
    \begin{center}
        \begin{tikzpicture}
            % Left ornamental line
            \draw[royalSecondary, line width=0.4pt, opacity=0.6] 
                (-2.5,0) -- (-1.2,0);
            \draw[royalAccent, line width=0.2pt, opacity=0.4] 
                (-2.5,0.08) -- (-1.2,0.08);
            
            % Left gold club
            \node[text=royalAccent, font=\small] at (-0.85,0) {$\clubsuit$};
            
            % Central royal symbol
            \node at (0,0) {\zetacircle};
            
            % Right gold club
            \node[text=royalAccent, font=\small] at (0.85,0) {$\clubsuit$};
            
            % Right ornamental line
            \draw[royalSecondary, line width=0.4pt, opacity=0.6] 
                (1.2,0) -- (2.5,0);
            \draw[royalAccent, line width=0.2pt, opacity=0.4] 
                (1.2,0.08) -- (2.5,0.08);
            
            % Corner decorations
            \fill[royalAccent, opacity=0.3] (-2.6,0) circle (0.05);
            \fill[royalAccent, opacity=0.3] (2.6,0) circle (0.05);
        \end{tikzpicture}
    \end{center}
    \vspace{1.2em}
}

%=============================================================================
% MATHEMATICAL AND TEXT MACROS - ROYAL THEME
%=============================================================================

%-----------------------------------------------------------------------------
% Common Mathematical Sets (Blackboard Bold)
%-----------------------------------------------------------------------------

\providecommand{\RR}{\mathbb{R}}  % Real numbers
\providecommand{\NN}{\mathbb{N}}  % Natural numbers
\providecommand{\ZZ}{\mathbb{Z}}  % Integers
\providecommand{\QQ}{\mathbb{Q}}  % Rational numbers
\providecommand{\CC}{\mathbb{C}}  % Complex numbers

%-----------------------------------------------------------------------------
% Equation Numbering Control
%-----------------------------------------------------------------------------

\providecommand{\useSubsubsectionEqNum}{%
    \numberwithin{equation}{subsection}%
}

%-----------------------------------------------------------------------------
% Highlighted Text Commands - Royal Palette
%-----------------------------------------------------------------------------

% Mathematical term highlighting
\providecommand{\mathterm}[1]{%
    \textcolor{royalPrimary}{\textbf{#1}}%
}

% Definition term highlighting
\providecommand{\defterm}[1]{%
    \textcolor{royalDark}{\textit{\textbf{#1}}}%
}

% Code or literal text
\providecommand{\code}[1]{%
    \texttt{\textcolor{royalSecondary}{#1}}%
}

%-----------------------------------------------------------------------------
% Key Concept Box - Royal Luxury Style
%-----------------------------------------------------------------------------

\providecommand{\keybox}[1]{%
    \begin{center}
        \begin{tikzpicture}
            % Main royal box
            \node[
                rectangle,
                rounded corners=4pt,
                draw=royalPrimary,
                fill=royalLight!12,
                line width=0.9pt,
                inner sep=10pt,
                drop shadow={opacity=0.18, shadow xshift=1pt, shadow yshift=-1pt, fill=royalDark}
            ] {
                \begin{minipage}{0.85\textwidth}
                    \centering
                    #1
                \end{minipage}
            };
        \end{tikzpicture}
    \end{center}
}

%-----------------------------------------------------------------------------
% Reference Shortcuts - Quick Linking
%-----------------------------------------------------------------------------

\providecommand{\thmref}[1]{Theorem~\ref{#1}}
\providecommand{\lemref}[1]{Lemma~\ref{#1}}
\providecommand{\propref}[1]{Proposition~\ref{#1}}
\providecommand{\corref}[1]{Corollary~\ref{#1}}
\providecommand{\defref}[1]{Definition~\ref{#1}}
\providecommand{\exref}[1]{Example~\ref{#1}}
\providecommand{\exerref}[1]{Exercise~\ref{#1}}
\providecommand{\secref}[1]{Section~\ref{#1}}
\providecommand{\chapref}[1]{Chapter~\ref{#1}}
\providecommand{\figref}[1]{Figure~\ref{#1}}
\providecommand{\tabref}[1]{Table~\ref{#1}}
\providecommand{\eqnref}[1]{Equation~\eqref{#1}}

%=============================================================================
% HEADER & FOOTER SETUP
%=============================================================================

\pagestyle{fancy}
\fancyhf{}
\fancyHeaderContent
\fancyFootPageNum

\endinput
